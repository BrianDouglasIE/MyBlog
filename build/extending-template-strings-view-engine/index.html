<!doctype html>
<html lang="en">
    <head>
        <!-- Google tag (gtag.js) -->
        <script
            async
            src="https://www.googletagmanager.com/gtag/js?id=G-SXTREFVFLB"
        ></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag() {
                dataLayer.push(arguments);
            }
            gtag("js", new Date());

            gtag("config", "G-SXTREFVFLB");
        </script>

        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />

        <!-- Meta Description -->
        <meta name="description" content="Template strings as a view engine - Part 2" />

        <!-- Keywords -->
        <meta
            name="keywords"
            content="Brian Douglas, blog, js"
        />

        <!-- Author -->
        <meta name="author" content="Brian Douglas" />

        <!-- Open Graph / Facebook -->
        <meta property="og:type" content="website" />
        <meta
            property="og:title"
            content="BrianDouglas.ie - Template strings as a view engine - Part 2"
        />
        <meta property="og:description" content="Template strings as a view engine - Part 2" />
        <meta property="og:url" content="https://www.briandouglas.ie" />
        <meta
            property="og:image"
            content="http://www.briandouglas.ie/images/og-images/extending-template-strings-view-engine.png"
        />
        <meta property="og:image:type" content="image/png" />
        <meta property="og:image:width" content="1280" />
        <meta property="og:image:height" content="640" />
        <meta property="og:site_name" content="BrianDouglas.ie" />
        <meta
            property="og:image:alt"
            content="A preview image for the post titled 'Template strings as a view engine - Part 2'"
        />

        <!-- Twitter Meta -->
        <meta name="twitter:card" content="summary_large_image" />
        <meta name="twitter:site" content="@BrianDouglasIE" />
        <meta
            name="twitter:title"
            content="BrianDouglas.ie - Template strings as a view engine - Part 2"
        />
        <meta name="twitter:description" content="Template strings as a view engine - Part 2" />
        <meta
            name="twitter:image"
            content="http://www.briandouglas.ie/images/og-images/extending-template-strings-view-engine.png"
        />

        <!-- Canonical URL -->
        <link rel="canonical" href="https://www.briandouglas.ie" />

        <!-- Favicon (Optional) -->
        <link
            rel="icon"
            href="https://www.briandouglas.ie/favicon.ico"
            type="image/x-icon"
        />

        <!-- Robots -->
        <meta name="robots" content="index, follow" />

        <!-- Favicon-->
        <link
            rel="apple-touch-icon"
            sizes="180x180"
            href="/apple-touch-icon.png"
        />
        <link
            rel="icon"
            type="image/png"
            sizes="32x32"
            href="/favicon-32x32.png"
        />
        <link
            rel="icon"
            type="image/png"
            sizes="16x16"
            href="/favicon-16x16.png"
        />
        <link rel="manifest" href="/site.webmanifest" />

        <title>Template strings as a view engine - Part 2</title>
        <link rel="stylesheet" href="/styles.css" />
        <style>
            pre code.hljs {
                display: block;
                overflow-x: auto;
                padding: 1em;
            }
            code.hljs {
                padding: 3px 5px;
            }
            .hljs {
                color: #24292e;
                background: #ffffff;
            }
            .hljs-doctag,
            .hljs-keyword,
            .hljs-meta .hljs-keyword,
            .hljs-template-tag,
            .hljs-template-variable,
            .hljs-type,
            .hljs-variable.language_ {
                color: #d73a49;
            }
            .hljs-title,
            .hljs-title.class_,
            .hljs-title.class_.inherited__,
            .hljs-title.function_ {
                color: #6f42c1;
            }
            .hljs-attr,
            .hljs-attribute,
            .hljs-literal,
            .hljs-meta,
            .hljs-number,
            .hljs-operator,
            .hljs-selector-attr,
            .hljs-selector-class,
            .hljs-selector-id,
            .hljs-variable {
                color: #005cc5;
            }
            .hljs-meta .hljs-string,
            .hljs-regexp,
            .hljs-string {
                color: #032f62;
            }
            .hljs-built_in,
            .hljs-symbol {
                color: #e36209;
            }
            .hljs-code,
            .hljs-comment,
            .hljs-formula {
                color: #6a737d;
            }
            .hljs-name,
            .hljs-quote,
            .hljs-selector-pseudo,
            .hljs-selector-tag {
                color: #22863a;
            }
            .hljs-subst {
                color: #24292e;
            }
            .hljs-section {
                color: #005cc5;
                font-weight: bold;
            }
            .hljs-bullet {
                color: #735c0f;
            }
            .hljs-emphasis {
                color: #24292e;
                font-style: italic;
            }
            .hljs-strong {
                color: #24292e;
                font-weight: bold;
            }
            .hljs-addition {
                color: #22863a;
                background-color: #f0fff4;
            }
            .hljs-deletion {
                color: #b31d28;
                background-color: #ffeef0;
            }
            .hljs-char.escape_,
            .hljs-link,
            .hljs-params,
            .hljs-property,
            .hljs-punctuation,
            .hljs-tag {
            }
        </style>
    </head>
    <body>
        <div class="content">
            <header class="site-header">
    <a href="/" class="home">Brian Douglas</a>

    <div class="svg-container">
        <a href="https://github.com/BrianDouglasIE" class="github">
            <svg
                height="32"
                aria-hidden="true"
                viewBox="0 0 24 24"
                width="32"
                data-view-component="true"
            >
                <path
                    d="M12.5.75C6.146.75 1 5.896 1 12.25c0 5.089 3.292 9.387 7.863 10.91.575.101.79-.244.79-.546 0-.273-.014-1.178-.014-2.142-2.889.532-3.636-.704-3.866-1.35-.13-.331-.69-1.352-1.18-1.625-.402-.216-.977-.748-.014-.762.906-.014 1.553.834 1.769 1.179 1.035 1.74 2.688 1.25 3.349.948.1-.747.402-1.25.733-1.538-2.559-.287-5.232-1.279-5.232-5.678 0-1.25.445-2.285 1.178-3.09-.115-.288-.517-1.467.115-3.048 0 0 .963-.302 3.163 1.179.92-.259 1.897-.388 2.875-.388.977 0 1.955.13 2.875.388 2.2-1.495 3.162-1.179 3.162-1.179.633 1.581.23 2.76.115 3.048.733.805 1.179 1.825 1.179 3.09 0 4.413-2.688 5.39-5.247 5.678.417.36.776 1.05.776 2.128 0 1.538-.014 2.774-.014 3.162 0 .302.216.662.79.547C20.709 21.637 24 17.324 24 12.25 24 5.896 18.854.75 12.5.75Z"
                ></path>
            </svg>
        </a>

        <a
            href="https://linkedin.com/in/brian-douglas-90abb93ab"
            class="linkedin"
        >
            <svg
                viewBox="0 0 128 128"
                height="32"
                aria-hidden="true"
                width="32"
                data-view-component="true"
            >
                <path
                    d="M116 3H12a8.91 8.91 0 00-9 8.8v104.42a8.91 8.91 0 009 8.78h104a8.93 8.93 0 009-8.81V11.77A8.93 8.93 0 00116 3zM39.17 107H21.06V48.73h18.11zm-9-66.21a10.5 10.5 0 1110.49-10.5 10.5 10.5 0 01-10.54 10.48zM107 107H88.89V78.65c0-6.75-.12-15.44-9.41-15.44s-10.87 7.36-10.87 15V107H50.53V48.73h17.36v8h.24c2.42-4.58 8.32-9.41 17.13-9.41C103.6 47.28 107 59.35 107 75z"
                ></path>
            </svg>
        </a>
    </div>
</header>

            <div class="breadcrumbs">
                <a href="/">Home</a> / <span>Template strings as a view engine - Part 2</span>
            </div>

            <main>
                <article class="post">
                    <header>
                        <h1>Template strings as a view engine - Part 2</h1>
                        <time datetime="20/08/2025"
                            >August 20th, 2025</time
                        >
                    </header>

                    <div class="body"><p>I've been thinking some more about using template strings as a view engine. This blog for
example now uses the template engine shown below. It's quite simple to implement and it's
usage in html files is super intuitive. You just need to remember that the html you are
writing will be intepretted as a template string, and you already know how to use template
strings, so there is no overhead.</p>
<!-- more -->
<p>I've expanded on my last post to make it a more full featured engine. The below code adds
helper methods that can be called inside a template. For example, to include one template
in another you can use the <code>helper.include()</code> method. Which essentially allows you to use
partials and layouts.</p>
<p>It's possible to pass in any var name to use in the template. But I have settled on <code>data</code>
as a single object to hold all the relevant view <em>data</em>. This reduces cognitive load, as I
know each template has access to <code>data</code> and <code>helpers</code>.</p>
<p>The implementation below reads all the html files inside the <em>viewDir</em> folder and registers
them as <em>views</em>. The same is true for all the html files in the <em>includesDir</em> folder. This
Means that the <code>helpers.include()</code> method can pull in any template from the includes dir.
Likewise <code>view</code> will render any file from the <code>viewDir</code>.</p>
<p>Implementation and example usage below.</p>
<h2 id="usage">Usage</h2>
<pre class="html language-html"><code class="hljs html language-html"><span class="hljs-comment">&lt;!-- index.html --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>${ data.title ?? &#x27;default title&#x27;}<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>Post List<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
        ${helpers.include(&#x27;post-list&#x27;, { posts })}
    <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<pre class="html language-html"><code class="hljs html language-html"><span class="hljs-comment">&lt;!-- includes/post-list.html --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
    ${data.posts.map(post =&gt; `
        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>${post.title}<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
    `).join(&#x27;&#x27;)}
<span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
</code></pre>
<h2 id="implementation">Implementation</h2>
<pre class="javascript language-javascript"><code class="hljs javascript language-javascript"><span class="hljs-keyword">import</span> {readFile} <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;node:fs/promises&#x27;</span>
<span class="hljs-keyword">import</span> {existsSync} <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;node:fs&#x27;</span>
<span class="hljs-keyword">import</span> {join} <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;node:path&#x27;</span>

<span class="hljs-keyword">const</span> outDir = <span class="hljs-string">&#x27;./docs&#x27;</span>
<span class="hljs-keyword">const</span> viewDir = <span class="hljs-string">&#x27;./views&#x27;</span>
<span class="hljs-keyword">const</span> includeDir = <span class="hljs-title function_">join</span>(viewDir, <span class="hljs-string">&#x27;./includes&#x27;</span>)

<span class="hljs-comment">/*
 * View engine
 */</span>

<span class="hljs-keyword">const</span> views = {}
<span class="hljs-keyword">const</span> includes = {}

<span class="hljs-keyword">const</span> templateHelpers = {
    <span class="hljs-attr">include</span>: <span class="hljs-function">(<span class="hljs-params">name, data</span>) =&gt;</span> includes[name](data),
    <span class="hljs-comment">// add methods here to make them available in templates</span>
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">compileTemplate</span>(<span class="hljs-params">template, ...varNames</span>) {
    <span class="hljs-keyword">const</span> fn = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Function</span>(<span class="hljs-string">&#x27;helpers&#x27;</span>, ...varNames, <span class="hljs-string">`return \`<span class="hljs-subst">${template}</span>\``</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-function">(<span class="hljs-params">...args</span>) =&gt;</span> <span class="hljs-title function_">fn</span>(templateHelpers, ...args)
}

<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> entry <span class="hljs-keyword">of</span> <span class="hljs-keyword">await</span> <span class="hljs-title function_">readdir</span>(includeDir)) {
    <span class="hljs-keyword">if</span> (!entry.<span class="hljs-title function_">endsWith</span>(<span class="hljs-string">&#x27;.html&#x27;</span>)) <span class="hljs-keyword">continue</span>

    includes[entry.<span class="hljs-title function_">replace</span>(<span class="hljs-string">&#x27;.html&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>)] = <span class="hljs-title function_">compileTemplate</span>(<span class="hljs-keyword">await</span> <span class="hljs-title function_">readFile</span>(<span class="hljs-title function_">join</span>(includeDir, entry)), <span class="hljs-string">&#x27;data&#x27;</span>)
}

<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> entry <span class="hljs-keyword">of</span> <span class="hljs-keyword">await</span> <span class="hljs-title function_">readdir</span>(viewDir)) {
    <span class="hljs-keyword">if</span> (!entry.<span class="hljs-title function_">endsWith</span>(<span class="hljs-string">&#x27;.html&#x27;</span>)) <span class="hljs-keyword">continue</span>

    views[entry.<span class="hljs-title function_">replace</span>(<span class="hljs-string">&#x27;.html&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>)] = <span class="hljs-title function_">compileTemplate</span>(<span class="hljs-keyword">await</span> <span class="hljs-title function_">readFile</span>(<span class="hljs-title function_">join</span>(viewDir, entry), <span class="hljs-string">&#x27;utf8&#x27;</span>), <span class="hljs-string">&#x27;data&#x27;</span>)
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">view</span>(<span class="hljs-params">name, data</span>) {
    <span class="hljs-keyword">return</span> views[name](data)
}
</code></pre></div>

                    <footer>
                        <p><i>Until next time,</i></p>
                        <p><i>Brian</i></p>
                    </footer>
                </article>
            </main>

            <footer class="site-footer">
    <p>
        <small>Since August 4th, 2023. All words by Brian
            Douglas. <a href="mailto:brianwdouglas@proton.me">Have a comment?</a></small>
    </p>
</footer>

        </div>

        <script src="/scripts/chicken-and-magpie.js"></script>
        <script src="/scripts/skip-to-section.js"></script>
    </body>
</html>
