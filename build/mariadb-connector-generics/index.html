<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>

    <!-- Meta Description -->
    <meta name="description" content="Add generics to MariaDB Node Connector"/>

    <!-- Keywords -->
    <meta name="keywords" content="Brian Douglas, blog, sql,node"/>

    <!-- Author -->
    <meta name="author" content="Brian Douglas"/>

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website"/>
    <meta property="og:title" content="BrianDouglas.ie - Add generics to MariaDB Node Connector"/>
    <meta property="og:description" content="Add generics to MariaDB Node Connector"/>
    <meta property="og:url" content="https://www.briandouglas.ie"/>
    <meta property="og:image" content="http://www.briandouglas.ie/images/og-images/mariadb-connector-generics.png"/>
    <meta property="og:image:type" content="image/png"/>
    <meta property="og:image:width" content="1280"/>
    <meta property="og:image:height" content="640"/>
    <meta property="og:site_name" content="BrianDouglas.ie"/>
    <meta property="og:image:alt" content="A preview image for the post titled 'Add generics to MariaDB Node Connector'"/>

    <!-- Twitter Meta -->
    <meta name="twitter:card" content="summary_large_image"/>
    <meta name="twitter:site" content="@BrianDouglasIE"/>
    <meta name="twitter:title" content="BrianDouglas.ie - Add generics to MariaDB Node Connector"/>
    <meta name="twitter:description" content="Add generics to MariaDB Node Connector"/>
    <meta name="twitter:image" content="http://www.briandouglas.ie/images/og-images/mariadb-connector-generics.png"/>

    <!-- Canonical URL -->
    <link rel="canonical" href="https://www.briandouglas.ie"/>

    <!-- Favicon (Optional) -->
    <link rel="icon" href="https://www.briandouglas.ie/favicon.ico" type="image/x-icon"/>

    <!-- Robots -->
    <meta name="robots" content="index, follow"/>

    <!-- Favicon-->
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"/>
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"/>
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"/>
    <link rel="manifest" href="/site.webmanifest"/>

    <title>Add generics to MariaDB Node Connector</title>
    <link rel="stylesheet" href="/styles.css">
    <style>
pre code.hljs{display:block;overflow-x:auto;padding:1em}code.hljs{padding:3px 5px}.hljs{color:#24292e;background:#ffffff}.hljs-doctag,.hljs-keyword,.hljs-meta .hljs-keyword,.hljs-template-tag,.hljs-template-variable,.hljs-type,.hljs-variable.language_{color:#d73a49}.hljs-title,.hljs-title.class_,.hljs-title.class_.inherited__,.hljs-title.function_{color:#6f42c1}.hljs-attr,.hljs-attribute,.hljs-literal,.hljs-meta,.hljs-number,.hljs-operator,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-id,.hljs-variable{color:#005cc5}.hljs-meta .hljs-string,.hljs-regexp,.hljs-string{color:#032f62}.hljs-built_in,.hljs-symbol{color:#e36209}.hljs-code,.hljs-comment,.hljs-formula{color:#6a737d}.hljs-name,.hljs-quote,.hljs-selector-pseudo,.hljs-selector-tag{color:#22863a}.hljs-subst{color:#24292e}.hljs-section{color:#005cc5;font-weight:bold}.hljs-bullet{color:#735c0f}.hljs-emphasis{color:#24292e;font-style:italic}.hljs-strong{color:#24292e;font-weight:bold}.hljs-addition{color:#22863a;background-color:#f0fff4}.hljs-deletion{color:#b31d28;background-color:#ffeef0}.hljs-char.escape_,.hljs-link,.hljs-params,.hljs-property,.hljs-punctuation,.hljs-tag{}
    </style>
</head>
<body>

<div class="content">
    <header class="site-header">
    <a href="/" class="home">Brian Douglas</a>

    <a href="https://github.com/BrianDouglasIE" class="github">
        <svg
                height="32"
                aria-hidden="true"
                viewBox="0 0 24 24"
                width="32"
                data-view-component="true"
        >
            <path
                    d="M12.5.75C6.146.75 1 5.896 1 12.25c0 5.089 3.292 9.387 7.863 10.91.575.101.79-.244.79-.546 0-.273-.014-1.178-.014-2.142-2.889.532-3.636-.704-3.866-1.35-.13-.331-.69-1.352-1.18-1.625-.402-.216-.977-.748-.014-.762.906-.014 1.553.834 1.769 1.179 1.035 1.74 2.688 1.25 3.349.948.1-.747.402-1.25.733-1.538-2.559-.287-5.232-1.279-5.232-5.678 0-1.25.445-2.285 1.178-3.09-.115-.288-.517-1.467.115-3.048 0 0 .963-.302 3.163 1.179.92-.259 1.897-.388 2.875-.388.977 0 1.955.13 2.875.388 2.2-1.495 3.162-1.179 3.162-1.179.633 1.581.23 2.76.115 3.048.733.805 1.179 1.825 1.179 3.09 0 4.413-2.688 5.39-5.247 5.678.417.36.776 1.05.776 2.128 0 1.538-.014 2.774-.014 3.162 0 .302.216.662.79.547C20.709 21.637 24 17.324 24 12.25 24 5.896 18.854.75 12.5.75Z"
            ></path>
        </svg>
    </a>
</header>
    <div class="breadcrumbs">
        <a href="/">Home</a> / <span>Add generics to MariaDB Node Connector</span>
    </div>

    <main>
        <article class="post">
            <header>
                <h1>Add generics to MariaDB Node Connector</h1>
                <time datetime="17/02/2026">February 17th, 2026</time>
            </header>

            <div class="body">
                <p>When working with an instance of a MariaDB database I noticed that the <a href="https://www.npmjs.com/package/mariadb">npm package</a>
used to connect did not support Typescript generics. This was something I felt I could fix, so I sent in a PR.</p>
<!-- more -->
<h2 id="whygenerics">Why generics?</h2>
<p>Generics allow us to replace loosely typed APIs, anywhere <code>any</code> is used in Typescript, with contextual type
information. You can think of a generic as a wildcard type. These are useful in the context of connecting to a database
as they allow us to typehint the return type of queries, as well as the argument lists of prepared statements, for example.
This means that we get <em>compile time</em> safety when working with queries and statements.</p>
<p>I've added a short video below to demonstrate the advantage of this. You'll notice that when the <code>email</code> value is changed to a 
<code>number</code>, an error is shown as it does not match the type supplied to the prepared statement.</p>
<video controls width="600" style="max-width: 100%">
  <source src="https://private-user-images.githubusercontent.com/164613613/501041355-5d9c210c-8eb7-49b5-be9f-43890d2c5aa5.mp4?jwt=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NzEzMjY1OTcsIm5iZiI6MTc3MTMyNjI5NywicGF0aCI6Ii8xNjQ2MTM2MTMvNTAxMDQxMzU1LTVkOWMyMTBjLThlYjctNDliNS1iZTlmLTQzODkwZDJjNWFhNS5tcDQ_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjYwMjE3JTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI2MDIxN1QxMTA0NTdaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT0yZDI0YzM5MzkzNjYwZjRhMTcxNTk0NWE2YmQyOTUxODc4MWYzYWFlZGEwYTIzNjliOWZiZmM1N2UxNzVlNzhjJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.TUdHL9g4gK6KeZz8Knzzst5dwJO7_y-x3pRADS1O7oY" type="video/mp4">
  Your browser does not support the video tag.
</video>
<p>Code example from video:</p>
<pre class="typescript language-typescript"><code class="hljs typescript language-typescript"><span class="hljs-keyword">type</span> <span class="hljs-title class_">UserInsertParams</span> = [<span class="hljs-built_in">string</span>, <span class="hljs-title class_">Buffer</span>, <span class="hljs-title class_">Buffer</span>&lt;<span class="hljs-title class_">ArrayBufferLike</span>&gt;]
<span class="hljs-keyword">const</span> userInsertSQL = <span class="hljs-string">&#x27;INSERT INTO users (email, password_hash, salt) VALUES (?, ?, ?)&#x27;</span>
<span class="hljs-keyword">const</span> userInsert = <span class="hljs-keyword">await</span> conn.<span class="hljs-property">prepare</span>&lt;<span class="hljs-title class_">UserInsertParams</span>&gt;(userInsertSQL) <span class="hljs-comment">// UserInsertParams passed as values type</span>

<span class="hljs-keyword">const</span> salt = crypto.<span class="hljs-title function_">randomBytes</span>(<span class="hljs-number">16</span>);
<span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> userInsert.<span class="hljs-title function_">execute</span>([ <span class="hljs-comment">// will only accept a value of type UserInsertParams</span>
  email,
  crypto.<span class="hljs-title function_">pbkdf2Sync</span>(password, salt, <span class="hljs-number">310000</span>, <span class="hljs-number">32</span>, <span class="hljs-string">&#x27;sha256&#x27;</span>),
  salt
])
</code></pre>
<h2 id="implementinggenerics">Implementing generics</h2>
<p><magpie-trinket>You can see the source PR at <a href="https://github.com/mariadb-corporation/mariadb-connector-nodejs/pull/334">mariadb-connector-nodejs/pull/334</a></magpie-trinket></p>
<p>This is actually something that is easy to implement. Even though the mariadb connector has an extensive codebase, 
I knew that I was looking for a .d.ts file that contained the type definitions. Usually this file is generated on the fly,
however in this instance it seemed to be static. Using the LSP command "go to definition" is was able to find the <code>Prepared</code>
interface inside a <code>callback.d.ts</code> file.</p>
<p>I notticed that the interface lacked a generic argument, as expected. So to fix I added the following:</p>
<pre class="typescript language-typescript"><code class="hljs typescript language-typescript"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Prepare</span> {} <span class="hljs-comment">// before</span>

<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Prepare</span>&lt;V&gt; {} <span class="hljs-comment">// after</span>
</code></pre>
<p>This allowed for any method within the interface to receive a generic also. See the <code>execute</code> method below.
Note that exceute did use a generic for it's result, but not for it's argument list.</p>
<pre class="typescript language-typescript"><code class="hljs typescript language-typescript">execute&lt;T = <span class="hljs-built_in">any</span>&gt;(<span class="hljs-attr">values</span>: <span class="hljs-built_in">any</span>, <span class="hljs-attr">callback</span>: <span class="hljs-function">(<span class="hljs-params"><span class="hljs-attr">err</span>: <span class="hljs-title class_">SqlError</span> | <span class="hljs-literal">null</span>, <span class="hljs-attr">result</span>?: T, <span class="hljs-attr">meta</span>?: <span class="hljs-built_in">any</span></span>) =&gt;</span> <span class="hljs-built_in">void</span>): <span class="hljs-built_in">void</span>; <span class="hljs-comment">// before</span>

execute&lt;T = <span class="hljs-built_in">any</span>&gt;(<span class="hljs-attr">values</span>: V, <span class="hljs-attr">callback</span>: <span class="hljs-function">(<span class="hljs-params"><span class="hljs-attr">err</span>: <span class="hljs-title class_">SqlError</span> | <span class="hljs-literal">null</span>, <span class="hljs-attr">result</span>?: T, <span class="hljs-attr">meta</span>?: <span class="hljs-built_in">any</span></span>) =&gt;</span> <span class="hljs-built_in">void</span>): <span class="hljs-built_in">void</span>; <span class="hljs-comment">// after </span>
</code></pre>
<p>The full list of changes can been seen on the pr, <a href="https://github.com/mariadb-corporation/mariadb-connector-nodejs/pull/334">mariadb-connector-nodejs/pull/334</a>.</p>
<p>I'm always glad to be able to contribute to an open source library. Especially a contribution that benefits my use of
said library.</p>
            </div>

            <footer>
                <p><i>Until next time,</i></p>
                <p><i>Brian</i></p>
            </footer>
        </article>
    </main>

    <footer class="site-footer">
    <p>
        <small>Since August 4th, 2023. All words by Brian
            Douglas. <a href="mailto:brianwdouglas@proton.me">Have a comment?</a></small>
    </p>
</footer>

</div>

<script src="/scripts/chicken-and-magpie.js"></script>
<script src="/scripts/skip-to-section.js"></script>
</body>
</html>
