<!doctype html>
<html lang="en">
    <head>
        <!-- Google tag (gtag.js) -->
        <script
            async
            src="https://www.googletagmanager.com/gtag/js?id=G-SXTREFVFLB"
        ></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag() {
                dataLayer.push(arguments);
            }
            gtag("js", new Date());

            gtag("config", "G-SXTREFVFLB");
        </script>

        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />

        <!-- Meta Description -->
        <meta name="description" content="GameDev in C Part 3: Drawing a Slime" />

        <!-- Keywords -->
        <meta
            name="keywords"
            content="Brian Douglas, blog, c,raylib,gamedev"
        />

        <!-- Author -->
        <meta name="author" content="Brian Douglas" />

        <!-- Open Graph / Facebook -->
        <meta property="og:type" content="website" />
        <meta
            property="og:title"
            content="BrianDouglas.ie - GameDev in C Part 3: Drawing a Slime"
        />
        <meta property="og:description" content="GameDev in C Part 3: Drawing a Slime" />
        <meta property="og:url" content="https://www.briandouglas.ie" />
        <meta
            property="og:image"
            content="http://www.briandouglas.ie/images/og-images/gamedev-in-c-part-3.png"
        />
        <meta property="og:image:type" content="image/png" />
        <meta property="og:image:width" content="1280" />
        <meta property="og:image:height" content="640" />
        <meta property="og:site_name" content="BrianDouglas.ie" />
        <meta
            property="og:image:alt"
            content="A preview image for the post titled 'GameDev in C Part 3: Drawing a Slime'"
        />

        <!-- Twitter Meta -->
        <meta name="twitter:card" content="summary_large_image" />
        <meta name="twitter:site" content="@BrianDouglasIE" />
        <meta
            name="twitter:title"
            content="BrianDouglas.ie - GameDev in C Part 3: Drawing a Slime"
        />
        <meta name="twitter:description" content="GameDev in C Part 3: Drawing a Slime" />
        <meta
            name="twitter:image"
            content="http://www.briandouglas.ie/images/og-images/gamedev-in-c-part-3.png"
        />

        <!-- Canonical URL -->
        <link rel="canonical" href="https://www.briandouglas.ie" />

        <!-- Favicon (Optional) -->
        <link
            rel="icon"
            href="https://www.briandouglas.ie/favicon.ico"
            type="image/x-icon"
        />

        <!-- Robots -->
        <meta name="robots" content="index, follow" />

        <!-- Favicon-->
        <link
            rel="apple-touch-icon"
            sizes="180x180"
            href="/apple-touch-icon.png"
        />
        <link
            rel="icon"
            type="image/png"
            sizes="32x32"
            href="/favicon-32x32.png"
        />
        <link
            rel="icon"
            type="image/png"
            sizes="16x16"
            href="/favicon-16x16.png"
        />
        <link rel="manifest" href="/site.webmanifest" />

        <title>GameDev in C Part 3: Drawing a Slime</title>
        <link rel="stylesheet" href="/styles.css" />
        <style>
            pre code.hljs {
                display: block;
                overflow-x: auto;
                padding: 1em;
            }
            code.hljs {
                padding: 3px 5px;
            }
            .hljs {
                color: #24292e;
                background: #ffffff;
            }
            .hljs-doctag,
            .hljs-keyword,
            .hljs-meta .hljs-keyword,
            .hljs-template-tag,
            .hljs-template-variable,
            .hljs-type,
            .hljs-variable.language_ {
                color: #d73a49;
            }
            .hljs-title,
            .hljs-title.class_,
            .hljs-title.class_.inherited__,
            .hljs-title.function_ {
                color: #6f42c1;
            }
            .hljs-attr,
            .hljs-attribute,
            .hljs-literal,
            .hljs-meta,
            .hljs-number,
            .hljs-operator,
            .hljs-selector-attr,
            .hljs-selector-class,
            .hljs-selector-id,
            .hljs-variable {
                color: #005cc5;
            }
            .hljs-meta .hljs-string,
            .hljs-regexp,
            .hljs-string {
                color: #032f62;
            }
            .hljs-built_in,
            .hljs-symbol {
                color: #e36209;
            }
            .hljs-code,
            .hljs-comment,
            .hljs-formula {
                color: #6a737d;
            }
            .hljs-name,
            .hljs-quote,
            .hljs-selector-pseudo,
            .hljs-selector-tag {
                color: #22863a;
            }
            .hljs-subst {
                color: #24292e;
            }
            .hljs-section {
                color: #005cc5;
                font-weight: bold;
            }
            .hljs-bullet {
                color: #735c0f;
            }
            .hljs-emphasis {
                color: #24292e;
                font-style: italic;
            }
            .hljs-strong {
                color: #24292e;
                font-weight: bold;
            }
            .hljs-addition {
                color: #22863a;
                background-color: #f0fff4;
            }
            .hljs-deletion {
                color: #b31d28;
                background-color: #ffeef0;
            }
            .hljs-char.escape_,
            .hljs-link,
            .hljs-params,
            .hljs-property,
            .hljs-punctuation,
            .hljs-tag {
            }
        </style>
    </head>
    <body>
        <div class="content">
            <header class="site-header">
    <a href="/" class="home">Brian Douglas</a>

    <div class="svg-container">
        <a href="https://github.com/BrianDouglasIE" class="github">
            <svg
                height="32"
                aria-hidden="true"
                viewBox="0 0 24 24"
                width="32"
                data-view-component="true"
            >
                <path
                    d="M12.5.75C6.146.75 1 5.896 1 12.25c0 5.089 3.292 9.387 7.863 10.91.575.101.79-.244.79-.546 0-.273-.014-1.178-.014-2.142-2.889.532-3.636-.704-3.866-1.35-.13-.331-.69-1.352-1.18-1.625-.402-.216-.977-.748-.014-.762.906-.014 1.553.834 1.769 1.179 1.035 1.74 2.688 1.25 3.349.948.1-.747.402-1.25.733-1.538-2.559-.287-5.232-1.279-5.232-5.678 0-1.25.445-2.285 1.178-3.09-.115-.288-.517-1.467.115-3.048 0 0 .963-.302 3.163 1.179.92-.259 1.897-.388 2.875-.388.977 0 1.955.13 2.875.388 2.2-1.495 3.162-1.179 3.162-1.179.633 1.581.23 2.76.115 3.048.733.805 1.179 1.825 1.179 3.09 0 4.413-2.688 5.39-5.247 5.678.417.36.776 1.05.776 2.128 0 1.538-.014 2.774-.014 3.162 0 .302.216.662.79.547C20.709 21.637 24 17.324 24 12.25 24 5.896 18.854.75 12.5.75Z"
                ></path>
            </svg>
        </a>

        <a
            href="https://linkedin.com/in/brian-douglas-90abb93ab"
            class="linkedin"
        >
            <svg
                viewBox="0 0 128 128"
                height="32"
                aria-hidden="true"
                width="32"
                data-view-component="true"
            >
                <path
                    d="M116 3H12a8.91 8.91 0 00-9 8.8v104.42a8.91 8.91 0 009 8.78h104a8.93 8.93 0 009-8.81V11.77A8.93 8.93 0 00116 3zM39.17 107H21.06V48.73h18.11zm-9-66.21a10.5 10.5 0 1110.49-10.5 10.5 10.5 0 01-10.54 10.48zM107 107H88.89V78.65c0-6.75-.12-15.44-9.41-15.44s-10.87 7.36-10.87 15V107H50.53V48.73h17.36v8h.24c2.42-4.58 8.32-9.41 17.13-9.41C103.6 47.28 107 59.35 107 75z"
                ></path>
            </svg>
        </a>
    </div>
</header>

            <div class="breadcrumbs">
                <a href="/">Home</a> / <span>GameDev in C Part 3: Drawing a Slime</span>
            </div>

            <main>
                <article class="post">
                    <header>
                        <h1>GameDev in C Part 3: Drawing a Slime</h1>
                        <time datetime="31/01/2025"
                            >January 31st, 2025</time
                        >
                    </header>

                    <div class="body"><p>It's part 3 and I am finally able to draw something meaningful on the screen.</p>
<!-- more -->
<p>I've decided that the game will be a DoodleJump clone, named SlimeJump. The 
goal will be to ascend to the highest platform possible. Sort of like a vertical
endless runner. The Slime's movement will be somewhat limited to add to the 
difficulty. There will be a start menu and high score list. I will create the
sprites and sfx myself.</p>
<h2 id="theslime">The Slime</h2>
<p>I have decided to go with pixel art. This means that the Slime will consist of
16x16 pixel frames. Each frame will correspond to a bounding box that will be 
displayed based on the Slime's state <em>(which will be the topic of part 4)</em> and
animation duration.</p>
<p>I've used a really nice image editor called <a href="https://www.aseprite.org/">Aseprite</a>
to create the pixel art for the slime. It had some preloaded color pallettes so
I decided to go for the default <em>pico-8</em> pallette that was availabel. I really liked
the bold popping colors. The resulting Slime sprite sheet is below. You can see that
I added an idle, walk, jump charge, damage, and death sequence. These will correspond
to Slime's game state.</p>
<p><img alt="The slime spritesheet" src="/images/slime.png" style="width: 500px; image-rendering: pixelated; margin: 2rem 0;" /></p>
<p><magpie-trinket>
The image above is only 144x16 pixels in size. If you are wondering how he got it to render crisply at 500px width,
It's by adding the css rule <code>image-rendering: pixelated;</code>.
</magpie-trinket></p>
<h2 id="renderingatexture">Rendering a texture</h2>
<p>When it comes to drawing the sprite on the screen. Raylib requires the texture to be
loaded first. Naturally this requires the <code>LoadTexture</code> method. This must be called 
after the window is initialised. Otherwise you will see some random error that is not
at all self explanatory. The code I use to render the texture looks like this:</p>
<pre class="c language-c"><code class="hljs c language-c"><span class="hljs-type">const</span> Texture2D slime_texture = LoadTexture(<span class="hljs-string">&quot;assets/sprites/slime.png&quot;</span>);
</code></pre>
<p>It's also important to remember that the texture needs to be unloaded. This is done like so,
outside of the game loop.</p>
<pre class="c language-c"><code class="hljs c language-c">UnloadTexture(slime_texture);
</code></pre>
<p>In order to draw a single frame of the texture to the screen the <code>DrawTexturePro</code> method is used.
This will take a texture, along with a source (frame<em>rec), and dest (player</em>bounds). The resulting
code looks like this.</p>
<pre class="c language-c"><code class="hljs c language-c">Rectangle frame_rec = { <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">16</span>, <span class="hljs-number">16</span> };
DrawTexturePro(slime_texture, frame_rec, player_get_bounds(&amp;player), sprite_origin, <span class="hljs-number">0</span>, WHITE);
</code></pre>
<p>If you have experience with raylib or gamedev in general, you notice that an important part is left out.
If this code were to run now, a 16x16 pixel slime would be drawn to the screen. Which would be much
to small to be usable. So the sprite needs to be scaled up. In order to do this a render texture must be
created.</p>
<p>A render texture is something that can be drawn to at a smaller scale, then drawn itself at a large scale
on the screen. To make this work a virtual screen width and height will be defined. I want the game window
to be 480x855 pixels in size. The virtual width of the game will be 160x285 pixels. This means that the Slime
will take up more space on the virtual screen, eg: it will look correctly sized. I define the screen sizes as
macros.</p>
<pre class="c language-c"><code class="hljs c language-c"><span class="hljs-meta">#<span class="hljs-keyword">define</span> SCREEN_WIDTH 480.0f</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> SCREEN_HEIGHT 855.0f</span>

<span class="hljs-meta">#<span class="hljs-keyword">define</span> V_SCREEN_WIDTH 160.0f</span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> V_SCREEN_HEIGHT 285.0f</span>
</code></pre>
<p>I then create the render texture, with a source rec (the virtual screen size), and a dest rec (the scaled screen size).</p>
<pre class="c language-c"><code class="hljs c language-c"><span class="hljs-type">const</span> RenderTexture2D render_texture = LoadRenderTexture(V_SCREEN_WIDTH, V_SCREEN_HEIGHT);
<span class="hljs-type">const</span> Rectangle render_texture_src = {<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, V_SCREEN_WIDTH, -V_SCREEN_HEIGHT};

<span class="hljs-type">const</span> <span class="hljs-type">float</span> virtual_ratio = (<span class="hljs-type">float</span>) SCREEN_WIDTH / (<span class="hljs-type">float</span>) V_SCREEN_HEIGHT;

<span class="hljs-type">const</span> Rectangle render_texture_dest = {
    -virtual_ratio, -virtual_ratio, SCREEN_WIDTH + (virtual_ratio * <span class="hljs-number">2</span>), SCREEN_HEIGHT + (virtual_ratio * <span class="hljs-number">2</span>)
};
</code></pre>
<p>The draw loop will then need to be updated as follows to account for drawing to the render texture. Then drawing
that render texture to the main out. Raylib provides the <code>BeginTextureMode</code> and <code>EndTextureMode</code> methods to accomodate
this like so:</p>
<pre class="c language-c"><code class="hljs c language-c">BeginTextureMode(render_texture);
ClearBackground(RAYWHITE);
DrawTexturePro(slime_texture, frame_rec, player_get_bounds(&amp;player), sprite_origin, <span class="hljs-number">0</span>, WHITE);
EndTextureMode();

BeginDrawing();
DrawTexturePro(render_texture.texture,
        render_texture_src,
        render_texture_dest,
        sprite_origin,
        <span class="hljs-number">0</span>,
        WHITE);
EndDrawing();
</code></pre>
<p>This will result in the following. Note the screenshot contains a floor which I have left out of these code examples.</p>
<p><img src="/images/slime-part-3.png" alt="the slime on screen" /></p></div>

                    <footer>
                        <p><i>Until next time,</i></p>
                        <p><i>Brian</i></p>
                    </footer>
                </article>
            </main>

            <footer class="site-footer">
    <p>
        <small>Since August 4th, 2023. All words by Brian
            Douglas. <a href="mailto:brianwdouglas@proton.me">Have a comment?</a></small>
    </p>
</footer>

        </div>

        <script src="/scripts/chicken-and-magpie.js"></script>
        <script src="/scripts/skip-to-section.js"></script>
    </body>
</html>
